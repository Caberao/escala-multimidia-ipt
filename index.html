<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Escala Multimídia IPT</title>
<style>
  body { font-family: Arial,sans-serif; max-width: 900px; margin: auto; padding: 20px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background-color: #003366; color: white; }
</style>
</head>
<body>
  <h1>Escala Multimídia - Igreja Presbiteriana na Trindade</h1>
  <table id="escala-table">
    <thead>
      <tr><th>Data</th><th>Som</th><th>Projeção</th><th>Transmissão</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const API_URL = 'COLE_AQUI_A_URL_DO_SEU_WEB_APP';

    async function carregarEscala() {
      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          body: JSON.stringify({action: 'getData'}),
          headers: {'Content-Type': 'application/json'}
        });
        const result = await response.json();
        if(result.status !== "ok") {
          alert("Erro ao carregar escala: " + result.message);
          return;
        }
        montarTabela(result.data.datas, result.data.escala);
      } catch (e) {
        alert("Erro ao conectar API: " + e.message);
      }
    }

    function montarTabela(datas, escala) {
      const tbody = document.querySelector("#escala-table tbody");
      tbody.innerHTML = '';
      datas.forEach(data => {
        const linha = document.createElement('tr');
        const esc = escala[data] || {};
        linha.innerHTML = `<td>${new Date(data).toLocaleDateString('pt-BR')}</td>
          <td>${esc.som || ''}</td>
          <td>${esc.projecao || ''}</td>
          <td>${esc.transmissao || ''}</td>`;
        tbody.appendChild(linha);
      });
    }

    carregarEscala();
  </script>
</body>
</html>
